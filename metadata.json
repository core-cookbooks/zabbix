{
  "name": "zabbix",
  "description": "Installs/Configures Zabbix Agent/Server",
  "long_description": "# DESCRIPTION\n\nThis cookbook install zabbix-agent and zabbix-server.\n\nBy defaut the cookbook installs zabbix-agent, check the attribute for enable/disable zabbix_server / web or disable zabbix_agent installation.\n\nDefault login password for zabbix frontend is admin / zabbix  CHANGE IT !\n\n# USAGE\n\nBe careful when you update your server version, you need to run the sql patch in /opt/zabbix-$VERSION.\n\nIf you do not specify source\\_url attributes for agent or server they will be set to download the specified\nbranch and version from the official Zabbix source repository. If you want to upgrade later, you need to\neither nil out the source\\_url attributes or set them to the url you wish to download from.\n\n    node['zabbix']['agent']['source_url'] = nil\n    node['zabbix']['server']['source_url'] = nil\n\nPlease include the default recipe before using any other recipe.\n\nInstalling the Agent :\n\n    \"recipe[zabbix]\"\n\nInstalling the Server :\n\n    \"recipe[zabbix]\",  \n    \"recipe[zabbix::server]\"\n\nInstalling the Database :\n\n    \"recipe[mysql::server]\",\n    \"recipe[zabbix]\",\n    \"recipe[zabbix::database]\"\n\nInstalling all 3 - Database MUST come before Server\n\n    \"recipe[database::mysql]\",\n    \"recipe[mysql::server]\",\n    \"recipe[zabbix]\",\n    \"recipe[zabbix::database]\",\n    \"recipe[zabbix::server]\"\n\nNOTE:\n\nIf you are running on Redhat, Centos, Scientific or Amazon, you will need packages from EPEL.\nInclude \"recipe[yum::epel]\" in your runlist or satisfy these requirements some other way.\n\n    \"recipe[yum::epel]\"\n\n# ATTRIBUTES\n\nDon't forget to set :\n\n    node.set['zabbix']['agent']['servers'] = [\"Your_zabbix_server.com\",\"secondaryserver.com\"]\n    node.set['zabbix']['web']['fqdn'] or you will not have the zabbix web interface\n\nNote :\n\nA Zabbix agent running on the Zabbix server will need to :\n\n* use a different account than the on the server uses or it will be able to spy on private data.\n* specify the local Zabbix server using the localhost (127.0.0.1, ::1) address.\n\nexample :\n\n## Server\n\n\t  node.set['zabbix']['server']['branch'] = \"ZABBIX%20Latest%20Stable\"\n\t  node.set['zabbix']['server']['version'] = \"2.0.0\"\n\t  node.set['zabbix']['server']['source_url'] = nil\n\t  ndoe.set['zabbix']['server']['install_method'] = \"source\"\n\n## Agent\n\n\t  node.set['zabbix']['agent']['branch'] = \"ZABBIX%20Latest%20Stable\"\n\t  node.set['zabbix']['agent']['version'] = \"2.0.0\"\n\t  node.set['zabbix']['agent']['source_url'] = nil\n\t  node.set['zabbix']['agent']['install_method'] = \"prebuild\"\n\n## Database\n\n    node.set['zabbix']['database']['install_method'] = 'mysql'\n    node.set['zabbix']['database']['dbname'] = \"zabbix\"\n    node.set['zabbix']['database']['dbuser'] = \"zabbix\"\n    node.set['zabbix']['database']['dbhost'] = \"localhost\"\n    node.set['zabbix']['database']['dbpassword'] = 'password'\n    node.set['zabbix']['database']['dbport'] = \"3306\"\n\nIf you are using AWS RDS\n\n    node.set['zabbix']['database']['install_method'] = 'rds_mysql'\n    node.set['zabbix']['database']['rds_master_user'] = 'username'\n    node.set['zabbix']['database']['rds_master_password'] = 'password'\n\n\n\n# RECIPES\n\n## default\n\nThe default recipe creates the Zabbix user and directories used by all Zabbix components.\n\nOptionally, it installs the Zabbix agent.\n\nYou can control the agent install with the following attributes:\n\n    node['zabbix']['agent']['install'] = true\n    node['zabbix']['agent']['install_method'] = 'source'\n\n## agent\\_prebuild\n\nDownloads and installs the Zabbix agent from a pre built package\n\nIf you are on a machine in the RHEL family of platforms, then you must have your\npackage manager setup to allow installation of:\n\n    package \"redhat-lsb\"\n\nYou can control the agent version with:\n\n    node['zabbix']['agent']['version']\n\n## agent\\_source\n\nDownloads and installs the Zabbix agent from source\n\nIf you are on a machine in the RHEL family of platforms, then you will\nneed to install packages from the EPEL repository. The easiest way to do this\nis to add the following recipe to your runlist before zabbix::agent\\_source\n\n    recipe \"yum::epel\"\n\nYou can control the agent install with:\n\n    node['zabbix']['agent']['branch']\n    node['zabbix']['agent']['version']\n    node['zabbix']['agent']['configure_options']\n\n## database\n\nWARNING: This recipe persists your database credentials back to the Chef server\nas plaintext  node attributes. To prevent this, consume the `zabbix_database`\nLWRP in your own wrapper cookbook.\n\nCreates and initializes the Zabbix database\n\nCurrenly only supports MySql and RDS MySql databases\n\nIf they are not already set, this recipe will generate the following attributes:\n\n    node['zabbix']['database']['dbpassword']\n    node['mysql']['server_root_password'] # Not generated if you are using RDS\n\nYou can control the database version with:\n\n    node['zabbix']['server']['branch']\n    node['zabbix']['server']['version']\n\nThe database setup uses the following attributes:\n\n    node['zabbix']['database']['dbhost']\n    node['zabbix']['database']['dbname']\n    node['zabbix']['database']['dbuser']\n    node['zabbix']['database']['dbpassword']\n\n    node['zabbix']['database']['install_method']\n\nIf `install_method` is 'mysql' you also need:\n\n    node['mysql']['server_root_password']\n\nIf `install_method` is 'rds\\_mysql' you also need:\n\n    node['zabbix']['database']['rds_master_username']\n    node['zabbix']['database']['rds_master_password']\n\n## firewall\n\nOpens firewall rules to allow Zabbix nodes to communicate with each other.\n\n## server\n\nDelegates to other recipes to install the Zabbix server and Web components.\n\nYou can control the server and web installs with the following attributes:\n\n    node['zabbix']['server']['install'] = true\n    node['zabbix']['server']['install_method'] = 'source'\n    node['zabbix']['web']['install'] = true\n\nIf you are using a MySql or RDS MySql database make sure your runlist\nincludes:\n\n    \"recipe[database::mysql]\",\n    \"recipe[mysql::client]\"\n\nIf you are user a Postgres database make sure your runlist includes:\n\n    \"recipe[database::postgresql]\",\n    \"recipe[postgresql::client]\",\n\n## server\\_source\n\nDownloads and installs the Zabbix Server component from source\n\nIf you are on a machine in the RHEL family of platforms, then you will\nneed to install packages from the EPEL repository. The easiest way to do this\nis to add the following recipe to your runlist before zabbix::server\\_source\n\n    recipe \"yum::epel\"\n\nYou can control the server install with:\n\n    node['zabbix']['server']['branch']\n    node['zabbix']['server']['version']\n    node['zabbix']['server']['configure_options']\n\nThe server also needs to know about:\n\n    node['zabbix']['database']['dbhost']\n    node['zabbix']['database']['dbname']\n    node['zabbix']['database']['dbuser']\n    node['zabbix']['database']['dbpassword']\n    node['zabbix']['database']['dbport']\n\n## web\n\nCreates an Apache site for the Zabbix Web component\n\n# LWRPs\n\n## database\n\n### resources/database\n\nInstalls the Zabbix Database\n\nThe default provider is Chef::Provider::ZabbixDatabaseMySql in \"providers/database_my_sql\".\nIf you want a different provider, make sure you set the following in your resource call.\n\n    provider Chef::Provider::SomeProviderClass\n\n#### Actions\n\n* `create` (Default Action) - Creates the Zabbix Database\n\n#### Attributes\n\n* `dbname` (Name Attribute) -  Name of the Zabbix databse to create\n* `host` - Host to create the database on\n* `port` - Port to connext to the database over\n* `username` - Name of the Zabbix database user\n* `password` - Password for the Zabbix database user\n* `root_username` - Name of the root user for the database server\n* `root_password` - Password for the database root user\n* `allowed_user_hosts` (Default: '') - Where users can connect to the database from\n* `server_branch` - Which branch of server code you are using\n* `server_version` - Which version of server code you are using\n* `source_dir` - Where Zabbix source code should be stored on the host\n* `install_dir` - Where Zabbix should be installed to\n\n### providers/database\\_my\\_sql\n\nInstalls a MySql or RDS MySql Zabbix Database\n\nThis is the default provider for `resources/database`\n\nIf you are using MySQL make sure you set\n\n    root_username \"root\"\n    root_password \"your root password\"\n\nIf you are using RDS MySql make sure you set\n\n    root_username \"your rds master username\"\n    root_password \"your rds master password\"\n\n### providers/database\\_postgres\n\nInstalls a Postgres Zabbix Database\n\nCall the `zabbix_database` resource with\n\n    provider Chef::Provider::ZabbixDatabasePostgres\n\nMake sure you set\n\n    root_username 'postgres'\n    root_pasword  'your postgres admin password'\n\nThe `allowed_user_hosts` attribute is ignored\n\n### resources/source\n\nFetchs the Zabbix source tar and does something with it\n\n#### Actions\n* `extract_only` (Default Action) - Just fetch and extract the tar\n* `install_server` - Fetch the tar then compile the source as a Server\n* `install_agent` - Fetch the tar then compile the source as an Agent\n\n#### Attributes\n* `name` (Name Attribute) - An arbitrary name for the resource\n* `branch` - The branch of Zabbix to grab code for\n* `version` - The version of Zabbix to grab code for\n* `code_dir` - Where Zabbix source code should be stored on the host\n* `target_dir` - A sub directory under `code_dir` where you want the source extracted\n* `install_dir` (Optional) - Where Zabbix should be installed to\n* `configure_options` (Optional) - Flags to use when compiling Zabbix\n\n### providers/source:\n\nDefault implementation of how to Fetch and handle the Zabbix source code.\n\n\n# TODO\n\n* Support more platform on agent side windows ?\n* LWRP Magic ?",
  "maintainer": "Cloudenablers",
  "maintainer_email": "nagalakshmi.n@cloudenablers.com",
  "license": "Apache 2.0",
  "platforms": {
    "ubuntu": ">= 10.04",
    "debian": ">= 6.0",
    "redhat": ">= 5.0",
    "centos": ">= 5.0",
    "oracle": ">= 5.0"
  },
  "dependencies": {
    "apache2": ">= 1.0.8",
    "database": ">= 1.3.0",
    "mysql": ">= 1.3.0",
    "ufw": ">= 0.6.1",
    "yum": ">= 0.0.0",
    "postgresql": ">= 0.0.0",
    "php-fpm": ">= 0.0.0",
    "nginx": ">= 1.0.0",
    "ark": ">= 0.7.2",
    "chocolatey": ">= 0.0.0",
    "java": ">= 0.0.0",
    "oracle-instantclient": ">= 0.0.0",
    "php": ">= 0.0.0",
    "yum-epel": ">= 0.0.0"
  },
  "recommendations": {
  },
  "suggestions": {
  },
  "conflicting": {
  },
  "providing": {
  },
  "replacing": {
  },
  "attributes": {
  },
  "groupings": {
  },
  "recipes": {
  },
  "version": "0.8.0"
}
